# Telegram Bot с DeepSeek AI

Этот проект представляет собой Telegram бота, интегрированного с ИИ DeepSeek-R1 для обработки сообщений пользователей.

## Возможности

- Обработка команд `/start`
- Ответы на текстовые сообщения через DeepSeek AI
- Поддержание активности воркера для предотвращения сна
- Обработка ошибок API с понятными сообщениями
- Логирование всех операций

## Установка и запуск

### Требования

- Python 3.8+
- Аккаунт Telegram Bot (получить токен у [@BotFather](https://t.me/botfather))
- API-ключ DeepSeek (получить на [platform.deepseek.com](https://platform.deepseek.com))

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Настройка переменных окружения

Создайте файл `.env` в корне проекта:

```env
TELEGRAM_TOKEN=ваш_токен_бота
DEEPSEEK_API_KEY=ваш_api_ключ_deepseek
UPTIME_ROBOT_URL=https://ваш_мониторинг_url (опционально)
```

### Запуск бота

```bash
python main.py
```

## Развертывание на Koyeb

Проект настроен для развертывания на Koyeb:

1. Создайте приложение на [Koyeb](https://www.koyeb.com)
2. Установите переменные окружения в настройках приложения
3. Разверните из GitHub репозитория

## Структура проекта

```
.
├── main.py                 # Основной код бота
├── pyproject.toml          # Конфигурация проекта (зависимости, метаданные)
├── requirements.txt        # Зависимости Python (для совместимости)
├── .env.example           # Пример переменных окружения
├── LICENSE                # Лицензия MIT
├── .koyeb/
│   └── app.yaml           # Конфигурация Koyeb
├── .github/
│   └── workflows/
│       └── ci.yml         # CI/CD пайплайн GitHub Actions
├── tests/                 # Тесты
│   ├── __init__.py        # Пакет тестов
│   ├── test_main.py       # Unit тесты основных функций
│   └── test_integration.py # Интеграционные тесты
├── .gitignore             # Игнорируемые файлы
└── README.md              # Документация
```

## Разработка

### Установка зависимостей для разработки

```bash
pip install -e ".[dev]"
```

### Линтинг и форматирование кода

```bash
# Форматирование кода
black .

# Проверка импортов
isort .

# Линтинг
flake8 main.py tests/

# Проверка типов
mypy main.py --ignore-missing-imports
```

## Тестирование

Запуск всех тестов:

```bash
pytest tests/
```

Запуск с покрытием:

```bash
pytest --cov=main tests/
```

### CI/CD

Проект использует GitHub Actions для автоматического тестирования и линтинга. Пайплайн запускается при каждом push и pull request в основную ветку.

## Обработка ошибок

Бот обрабатывает следующие типы ошибок:

- **Таймаут API**: Превышено время ожидания ответа
- **Ошибка баланса (402)**: Недостаточно средств на API-аккаунте
- **Общая ошибка API**: Проблемы с сервером ИИ
- **Критические ошибки**: Внутренние ошибки бота

## Лицензия

MIT License
